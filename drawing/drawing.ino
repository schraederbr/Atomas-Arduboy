//Use this to get hex file:
//arduino-cli compile --fqbn arduboy:avr:arduboy .\drawing.ino --output-dir ./
#include <Arduboy2.h>
Arduboy2 arduboy;
const unsigned char PROGMEM background[] = {0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x80, 0x80, 0x80, 0x80, 0x80, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x80, 0x40, 0x40, 0x40, 0x40, 0x40, 0x80, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x50, 0x50, 0x70, 0x50, 0x70, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x7c, 0x82, 0x01, 0x20, 0x20, 0x20, 0x20, 0x38, 0x01, 0x82, 0x7c, 0x00, 0x00, 0x00, 0x00, 0x3e, 0x41, 0x80, 0x1c, 0x14, 0x1c, 0x14, 0x1c, 0x80, 0x41, 0x3e, 0x00, 0x00, 0x00, 0x00, 0x80, 0x80, 0x80, 0x80, 0x80, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0xe0, 0xa0, 0xa0, 0xa0, 0xe0, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0xce, 0x4a, 0x46, 0x4a, 0xce, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0xf0, 0x08, 0x04, 0xe2, 0xa2, 0xe2, 0x22, 0xe2, 0x04, 0x08, 0xf0, 0x00, 0x01, 0x02, 0x02, 0x02, 0x02, 0x02, 0x01, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x01, 0x01, 0x01, 0x01, 0x01, 0x00, 0x00, 0x00, 0x00, 0x7c, 0x82, 0x01, 0x38, 0x20, 0x38, 0x28, 0x38, 0x01, 0x82, 0x7c, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0xe4, 0x24, 0xe4, 0x84, 0xe4, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x19, 0x28, 0x28, 0x28, 0x19, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x01, 0x82, 0x84, 0x88, 0x88, 0x88, 0x08, 0x08, 0x04, 0x02, 0x01, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0xc0, 0x20, 0x10, 0x48, 0x48, 0x48, 0x48, 0x48, 0x10, 0x20, 0xc0, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x01, 0x02, 0x82, 0x42, 0x22, 0x22, 0x21, 0x20, 0x20, 0x40, 0x80, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x8e, 0x88, 0xec, 0xa8, 0xae, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x27, 0x21, 0x63, 0x21, 0xe7, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x7c, 0x82, 0x01, 0x38, 0x20, 0x38, 0x08, 0x38, 0x01, 0x82, 0x7c, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x07, 0x08, 0x10, 0x27, 0x25, 0x25, 0x25, 0x27, 0x10, 0x08, 0x07, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x1f, 0x20, 0x40, 0x84, 0x84, 0x84, 0x84, 0x84, 0x40, 0x20, 0x1f, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0xee, 0xa8, 0xee, 0x22, 0xee, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x9c, 0x94, 0x94, 0x84, 0x9c, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x01, 0x02, 0x02, 0x02, 0x02, 0x02, 0x81, 0x40, 0x20, 0x10, 0x10, 0x10, 0x10, 0x10, 0x20, 0x40, 0x80, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0xc0, 0x20, 0x10, 0x88, 0x88, 0x88, 0x08, 0x88, 0x10, 0x20, 0xc0, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0xe8, 0xa8, 0xe8, 0xa8, 0xee, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x72, 0x22, 0x23, 0x22, 0x72, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x0f, 0x10, 0x20, 0x44, 0x44, 0x47, 0x45, 0x45, 0x20, 0x10, 0x0f, 0x00, 0x00, 0x00, 0xf8, 0x04, 0x02, 0x71, 0x41, 0x61, 0x41, 0x71, 0x02, 0x04, 0xf8, 0x00, 0x00, 0x07, 0x08, 0x10, 0x23, 0x20, 0x23, 0x22, 0x23, 0x10, 0x08, 0x07, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x0e, 0x08, 0x0e, 0x0a, 0x0e, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0xca, 0x8a, 0x8e, 0x8a, 0xca, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x01, 0x02, 0x04, 0x04, 0x04, 0x04, 0x04, 0x02, 0x01, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x01, 0x00, 0x00, 0x00, 0x01, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,    };
int centerX = 64;
int centerY = 32;
int radius = 24;
int baseNum = 1;
int index = 0;
int nextNum = 1;
int nums[50] = {1};
int count = 1;
//degrees * pi/180
//Do wide circle, x * 2 kind of. But make sure they're evenly spaced
void setup() {
  arduboy.begin();
  arduboy.clear();
  // arduboy.print("Holmes is cool!");
  // arduboy.display();
  //arduboy.drawBitmap(0, 0, background, 128, 64, WHITE);
  //arduboy.display();
  // arduboy.print(sin(0.5));
  // arduboy.display();
  // arduboy.drawLine(1, 1, 50, 50, WHITE);
  // arduboy.display();
  //drawLineOnCircle(0.785f);
  //drawLines(5);
  //arduboy.drawLine(centerX, centerY, centerX + cos(0.785f) * radius, centerY + sin(0.785f) * radius, WHITE);
  //arduboy.drawCircle(64, 32, 5, WHITE);
  //arduboy.display();

  
  
}

// void drawCircle(int i){
//   arduboy.drawCircle(centerX + cos(i * currentStep) * radius, centerY + sin(i * currentStep) * radius, 5, WHITE);
// }

void drawCircleNumber(int x, int y, int num){
  arduboy.drawCircle(x, y, 5, WHITE);
  arduboy.setCursor(x - 2, y - 3);
  arduboy.print(num);
}

void drawAtom(int i, int num){
  float currentStep = 2 * PI / count;
  int x = centerX + cos(i * currentStep) * radius * 2;
  int y = centerY + sin(i * currentStep) * radius;
  drawCircleNumber(x, y, num);
}

void drawAtoms(int nums[]){
  for (int i = 0; i < count; i++){
    drawAtom(i, nums[i]);
  }
  drawCircleNumber(centerX, centerY, nextNum);

}

// void drawCircles(){
//   float currentStep = 2 * PI / count;
//   for (int i = 0; i < count; i++){
//     arduboy.drawCircle(centerX + cos(i * currentStep) * radius, centerY + sin(i * currentStep) * radius, 5, WHITE);
//     //drawCircle(i);
//   }
// }

void drawLine(){
  float currentStep = 2 * PI / count;
  drawLineOnCircle(index * currentStep + currentStep/2);
}

void drawLineOnCircle(float angle){
  arduboy.drawLine(centerX, centerY, centerX + cos(angle) * radius * 2, centerY + sin(angle) * radius, WHITE);
  return;
}

void addAtom(int i, int num){
  count++;
  for (int j = count - 1; j > i; j--){
    nums[j] = nums[j - 1];
  }
  nums[i] = num;
}

void generateAtomNum(){
  nextNum = baseNum;
  baseNum++;
}

void loop() {
  arduboy.pollButtons();
  if (arduboy.justPressed(A_BUTTON)){
    addAtom(index + 1, nextNum);
    generateAtomNum();
  }

  if(arduboy.justPressed(LEFT_BUTTON)){
    if(index > 0){
      index--;
    }
    else{
      index = count - 1;
    }
  }
  
  if (arduboy.justPressed(RIGHT_BUTTON)){
    if(index < count - 1){
      index++;
    }
    else{
      index = 0;
    }
  }

  arduboy.clear();
  //drawCircles();
  drawAtoms(nums);
  drawLine();
  arduboy.display();
}